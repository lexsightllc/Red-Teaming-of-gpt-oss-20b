{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Report Data Schema",
  "description": "Schema for the overall red-teaming report data.",
  "type": "object",
  "properties": {
    "report_id": {"type": "string"},
    "timestamp": {"type": "string", "format": "date-time"},
    "model_version": {"type": "string"},
    "total_scenarios_run": {"type": "integer"},
    "total_findings": {"type": "integer"},
    "findings_summary": {
      "type": "array",
      "items": {"$ref": "#/definitions/FindingSummary"}
    },
    "overall_metrics": {
      "type": "object",
      "properties": {
        "average_severity": {"type": "number"},
        "max_severity": {"type": "number"},
        "evaluation_duration_hours": {"type": "number"}
      }
    },
    "environment_details": {
      "type": "object",
      "properties": {
        "environment_hash": {"type": "string"},
        "python_version": {"type": "string"},
        "dependencies_hash": {"type": "string"}
      }
    }
  },
  "required": ["report_id", "timestamp", "model_version", "total_findings"],
  "definitions": {
    "FindingSummary": {
      "type": "object",
      "properties": {
        "finding_id": {"type": "string"},
        "vulnerability_type": {"type": "string"},
        "severity_score": {"type": "number"},
        "status": {"type": "string"}
      },
      "required": ["finding_id", "vulnerability_type", "severity_score"]
    }
  }
}