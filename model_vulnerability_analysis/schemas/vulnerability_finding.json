{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Vulnerability Finding Schema",
  "description": "Schema for documenting a discovered model vulnerability finding, including essential metadata for self-verification.",
  "type": "object",
  "required": [
    "finding_id",
    "vulnerability_type",
    "severity_score",
    "model_version_tested",
    "timestamp_found",
    "reproduction_status",
    "reproduction_instructions",
    "minimal_trigger_prompt",
    "expected_vulnerable_output_pattern",
    "actual_vulnerable_output_excerpt",
    "rng_seed",
    "environment_hash",
    "input_data_hash"
  ],
  "properties": {
    "finding_id": {
      "type": "string",
      "description": "Unique identifier for the finding (e.g., UUID)."
    },
    "vulnerability_type": {
      "type": "string",
      "description": "Categorization of the vulnerability (e.g., 'data_exfiltration', 'refusal_bypass', 'hallucination')."
    },
    "severity_score": {
      "type": "number",
      "format": "float",
      "description": "Quantified risk/impact score (normalized, e.g., 0-10 or 0-1)."
    },
    "model_version_tested": {
      "type": "string",
      "description": "Specific identifier of the model instance or version tested."
    },
    "timestamp_found": {
      "type": "string",
      "format": "date-time",
      "description": "UTC timestamp of the initial discovery."
    },
    "reproduction_status": {
      "type": "string",
      "enum": ["reproduced", "fixed", "cannot_reproduce", "pending_verification"],
      "description": "Current status of the finding's reproducibility."
    },
    "reproduction_instructions": {
      "type": "string",
      "description": "Concise, executable steps to reproduce the vulnerability. May include API calls, prompt sequences, and configuration."
    },
    "minimal_trigger_prompt": {
      "type": "string",
      "description": "The most concise prompt or prompt sequence found to reliably trigger the vulnerability."
    },
    "expected_vulnerable_output_pattern": {
      "type": "string",
      "description": "Regular expression or semantic description of the expected harmful output pattern."
    },
    "actual_vulnerable_output_excerpt": {
      "type": "string",
      "description": "A sanitised, representative excerpt of the actual harmful output observed."
    },
    "mitigation_recommendations": {
      "type": "string",
      "description": "Suggested fixes or countermeasures for the vulnerability.",
      "nullable": true
    },
    "rng_seed": {
      "type": "integer",
      "description": "Random Number Generator seed used for the specific run that found this vulnerability."
    },
    "environment_hash": {
      "type": "string",
      "description": "Cryptographic hash of the execution environment (e.g., Docker image ID, `pip freeze` hash).",
      "pattern": "^[a-fA-F0-9]{64}$|^[a-fA-F0-9]{32}$"
    },
    "input_data_hash": {
      "type": "string",
      "description": "Cryptographic hash of any specific input data files used to trigger the vulnerability. (SHA256 recommended).",
      "pattern": "^[a-fA-F0-9]{64}$"
    },
    "contact_info": {
      "type": "string",
      "description": "Contact information for the person/team who discovered the finding, for responsible disclosure.",
      "nullable": true
    },
    "notes": {
      "type": "string",
      "description": "Any additional notes or observations about the finding.",
      "nullable": true
    }
  },
  "additionalProperties": false
}