{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "CodeAdviceCard",
  "type": "object",
  "required": ["task", "language", "budgets", "measured", "justification", "alternatives"],
  "properties": {
    "task": { "type": "string", "minLength": 3 },
    "language": { "type": "string", "enum": ["python", "javascript", "go", "java", "rust"] },
    "budgets": {
      "type": "object",
      "required": ["cyclomatic_per_fn_max", "nesting_depth_max", "avg_fn_length_max", "duplication_pct_max", "bigo_target"],
      "properties": {
        "cyclomatic_per_fn_max": { "type": "number" },
        "nesting_depth_max": { "type": "number" },
        "avg_fn_length_max": { "type": "number" },
        "duplication_pct_max": { "type": "number" },
        "bigo_target": { "type": "string" }
      }
    },
    "measured": {
      "type": "object",
      "required": ["cyclomatic_total", "avg_fn_length", "duplication_pct", "mi_proxy"],
      "properties": {
        "cyclomatic_total": { "type": "number" },
        "avg_fn_length": { "type": "number" },
        "duplication_pct": { "type": "number" },
        "mi_proxy": { "type": "number" }
      }
    },
    "justification": { "type": "string", "minLength": 40 },
    "alternatives": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["label", "intent", "expected_metric_delta"],
        "properties": {
          "label": { "type": "string" },
          "intent": { "type": "string" },
          "expected_metric_delta": { "type": "object" }
        }
      }
    }
  }
}
